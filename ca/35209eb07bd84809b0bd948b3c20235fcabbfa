---------------------------------------------------------------------------

by javiereguiluz at 2015-11-06T21:39:26Z

OK. I'm going to merge this as is and I'm gonna tweak it a bit afterwards. @ogizanagi thanks as always for your invaluable contributions!
